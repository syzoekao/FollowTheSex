import numpy as np

class PowerLawDD:
	'''
	Get base case data used in the model
	'''
	def __init__(self): 
		self.nPart10yr = np.arange(1, 251)
		self.plDist10yr = np.array([0.172177071738765, 0.0849033295563347, 0.0561450712841286, 
			0.0418672201644175, 0.0333446307842469, 0.0276860527482593, 0.0236578523260089, 
			0.0206454108861862, 0.0183082973689008, 0.0164427826993402, 0.0149195175110945, 
			0.0136524453393308, 0.0125820989999687, 0.0116660738409921, 0.0108733215951365, 
			0.01018058970683, 0.00957012075221169, 0.00902812081439985, 0.00854371286782117, 
			0.00810820502548343, 0.00771456844897717, 0.00735705805235139, 0.00703093243694124, 
			0.00673224404497797, 0.00645767982292506, 0.00620443876247115, 0.00597013673474228, 
			0.00575273177751045, 0.00555046488615941, 0.00536181268179878, 0.00518544926783666, 
			0.00502021525995211, 0.00486509246397301, 0.00471918303589088, 0.00458169222529177, 
			0.00445191400363917, 0.00432921903022058, 0.00421304452402299, 0.00410288569856166, 
			0.00399828848543458, 0.00389884332600371, 0.00380417985271695, 0.00371396231486687, 
			0.00362788563004258, 0.00354567196368892, 0.00346706775619732, 0.00339184113069888, 
			0.00331977962589397, 0.00325068820736153, 0.00318438751825779, 0.00312071233645954, 
			0.00305951021028768, 0.00300064024916199, 0.00294397204905002, 0.00288938473550858, 
			0.00283676610957951, 0.0027860118838747, 0.00273702499793621, 0.00268971500344083, 
			0.0026439975110786, 0.00259979369200894, 0.00255702982771583, 0.00251563690286988, 
			0.0024755502364807, 0.00243670914720487, 0.00239905664917718, 0.00236253917516754, 
			0.00232710632424292, 0.00229271063144164, 0.00225930735725285, 0.00222685429494311, 
			0.00219531159399046, 0.00216464159807701, 0.00213480869625928, 0.00210577918608297, 
			0.00207752114753907, 0.00205000432687292, 0.0020232000293598, 0.00199708102025007, 
			0.0019716214331674, 0.00194679668531401, 0.00192258339890026, 0.00189895932827241, 
			0.00187590329226209, 0.00185339511132661, 0.00183141554908878, 0.00180994625792158, 
			0.00178896972825474, 0.00176846924131005, 0.0017484288249976, 0.00172883321272948, 
			0.0017096678049281, 0.00169091863302594, 0.00167257232577049, 0.00165461607766427, 
			0.00163703761938368, 0.00161982519003345, 0.00160296751110542, 0.00158645376202052, 
			0.00157027355714314, 0.00155441692416522, 0.00153887428376614, 0.00152363643046118, 
			0.00150869451455853, 0.00149404002515061, 0.00147966477407133, 0.00146556088075575, 
			0.00145172075794373, 0.00143813709817296, 0.00142480286101123, 0.00141171126098095, 
			0.00139885575613285, 0.00138623003722817, 0.00137382801749219, 0.00136164382290401, 
			0.00134967178299028, 0.00133790642209251, 0.00132634245107991, 0.00131497475948142, 
			0.00130379840801238, 0.00129280862147303, 0.00128200078199737, 0.00127137042263243, 
			0.00126091322122918, 0.00125062499462776, 0.00124050169312033, 0.0012305393951765, 
			0.00122073430241677, 0.00121108273482049, 0.00120158112615578, 0.00119222601961939, 
			0.00118301406367539, 0.00117394200808229, 0.0011650067000985, 0.00115620508085706, 
			0.00114753418190085, 0.00113899112186997, 0.00113057310333369, 0.0011222774097595, 
			0.00111410140261261, 0.00110604251857916, 0.0010980982669072, 0.0010902662268596, 
			0.00108254404527342, 0.00107492943422061, 0.00106742016876516, 0.00106001408481207, 
			0.00105270907704386, 0.00104550309694041, 0.00103839415087822, 0.00103138029830556, 
			0.0010244596499898, 0.00101763036633368, 0.00101089065575749, 0.00100423877314396, 
			0.000997673018343277, 0.000991191734735336, 0.00098479330784679, 0.000978476164020475, 
			0.000972238769134881, 0.000966079627371497, 0.000959997280027971, 0.00095399030437509, 
			0.000948057312555721, 0.000942196950523916, 0.000936407897022495, 0.000930688862597474, 
			0.000925038588647819, 0.000919455846509034, 0.000913939436569205, 0.000908488187416168, 
			0.000903100955014511, 0.000897776621911221, 0.000892514096468815, 0.000887312312124842, 
			0.000882170226676713, 0.000877086821590864, 0.000872061101335266, 0.000867092092734395, 
			0.000862178844345766, 0.000857320425857208, 0.000852515927504069, 0.000847764459505591, 
			0.000843065151519734, 0.000838417152115726, 0.000833819628263692, 0.000829271764840712, 
			0.000824772764152688, 0.000820321845471449, 0.000815918244586516, 0.000811561213370992, 
			0.000807250019361069, 0.000802983945348644, 0.000798762288986581, 0.000794584362406154, 
			0.000790449491846242, 0.000786357017293854, 0.000782306292135582, 0.000778296682819603, 
			0.000774327568527842, 0.000770398340857969, 0.000766508403514858, 0.000762657172011206, 
			0.000758844073376981, 0.000755068545877404, 0.00075133003873917, 0.000747628011884632, 
			0.000743961935673678, 0.000740331290653044, 0.000736735567312809, 0.000733174265849841, 
			0.00072964689593796, 0.000726152976504591, 0.000722692035513706, 0.000719263609754842, 
			0.000715867244637996, 0.000712502493994212, 0.000709168919881677, 0.000705866092397137, 
			0.000702593589492489, 0.000699350996796351, 0.000696137907440488, 0.000692953921890907, 
			0.000689798647783503, 0.000686671699764097, 0.000683572699332736, 0.000680501274692121, 
			0.000677457060600037, 0.000674439698225665, 0.000671448835009651, 0.000668484124527821, 
			0.000665545226358439, 0.000662631805952884, 0.000659743534509663, 0.000656880088851649, 
			0.000654041151306445, 0.000651226409589793, 0.000648435556691931, 0.000645668290766811, 
			0.000642924315024093, 0.000640203337623841, 0.00063750507157384, 0.00063482923462945, 
			0.000632175549195936, 0.000629543742233196, 0.000626933545162821, 0.000624344693777421, 
			0.000621776928152146, 0.000619229992558357, 0.000616703635379365])
		self.nPart20yr = np.arange(1, 501)
		self.plDist20yr = np.array([0.134990933451086, 0.0689136899570458, 0.0465047145931354, 0.0351808565366849, 
			0.0283337264236106, 0.0237409387510718, 0.0204437001106324, 0.0179600405583602, 
			0.0160209906258085, 0.0144645391224884, 0.0131872334926921, 0.012119893170258, 
			0.0112144905348886, 0.0104366328536386, 0.00976103970099179, 0.00916870959413939, 
			0.00864508259205973, 0.00817881284739586, 0.00776092716256585, 0.00738423491841335,
			0.00704290587943159, 0.00673216265028531, 0.0064480530150674, 0.00618727894455462, 
			0.00594706646234804, 0.00572506540987492, 0.00551927138738166, 0.00532796434755954, 
			0.00514965983724945, 0.00498306994711096, 0.00482707178542158, 0.0046806818363521, 
			0.00454303495925449, 0.00441336707711658, 0.00429100081918381, 0.00417533354554047, 
			0.00406582730475145, 0.00396200036985503, 0.00386342007051451, 0.00376969669538525, 
			0.00368047828269133, 0.00359544615155707, 0.0035143110539788, 0.00343680984908719, 
			0.00336270261877528, 0.00329177015779332, 0.00322381178275935, 0.00315864341376154, 
			0.00309609588976518, 0.00303601348522196, 0.00297825260037556, 0.00292268060197456, 
			0.00286917479460714, 0.00281762150579272, 0.00276791527041038, 0.00271995810209695, 
			0.00267365884097702, 0.00262893256854951, 0.00258570008179516, 0.0025438874196237, 
			0.00250342543567868, 0.00246424941228725, 0.00242629871100166, 0.00238951645574645, 
			0.00235384924507424, 0.00231924689045526, 0.00228566217789186, 0.00225305065046647, 
			0.00222137040970809, 0.00219058193390308, 0.00216064791168652, 0.00213153308943441, 
			0.00210320413113907, 0.00207562948959131, 0.00204877928781874, 0.00202262520983918, 
			0.00199714039988598, 0.00197229936934793, 0.00194807791074305, 0.00192445301811334, 
			0.00190140281328781, 0.00187890647751492, 0.00185694418801342, 0.00183549705903351, 
			0.00181454708705823, 0.00179407709980959, 0.00177407070875464, 0.00175451226483396, 
			0.00173538681716052, 0.00171668007445845, 0.00169837836903219, 0.00168046862307403, 
			0.00166293831713482, 0.00164577546059751, 0.00162896856400648, 0.00161250661311785, 
			0.00159637904454724, 0.00158057572290122, 0.00156508691928796, 0.00154990329111109, 
			0.00153501586305802, 0.00152041600920121, 0.00150609543613703, 0.00149204616709261, 
			0.00147826052693651, 0.00146473112803367, 0.00145145085688977, 0.00143841286153386, 
			0.00142561053959222, 0.00141303752700955, 0.00140068768737685, 0.00138855510182826, 
			0.00137663405947173, 0.00136491904832089, 0.00135340474669773, 0.0013420860150778, 
			0.0013309578883516, 0.00132001556847747, 0.00130925441750322, 0.00129866995093489, 
			0.00128825783143275, 0.00127801386281587, 0.00126793398435765, 0.00125801426535606, 
			0.00124825089996326, 0.00123864020226022, 0.00122917860156281, 0.001219862637947, 
			0.00121068895798105, 0.00120165431065376, 0.00119275554348828, 0.00118398959883176, 
			0.00117535351031148, 0.00116684439944895, 0.00115845947242374, 0.00115019601697937, 
			0.00114205139946407, 0.00113402306199956, 0.00112610851977142, 0.00111830535843508, 
			0.00111061123163161, 0.00110302385860793, 0.00109554102193648, 0.00108816056532933, 
			0.00108088039154238, 0.00107369846036523, 0.00106661278669268, 0.00105962143867408, 
			0.00105272253593678, 0.00104591424788034, 0.00103919479203815, 0.00103256243250343, 
			0.00102601547841667, 0.00101955228251165, 0.00101317123971754, 0.00100687078581444, 
			0.00100064939614011, 0.000994505584345493, 0.000988437901197058, 0.000982444933423762, 
			0.000976525302606807, 0.000970677664110312, 0.000964900706051144, 0.000959193148306259, 
			0.000953553741555968, 0.000947981266361601, 0.000942474532276157, 0.000937032376986555, 
			0.000931653665486192, 0.000926337289276557, 0.000921082165596725, 0.000915887236679593, 
			0.00091075146903379, 0.000905673852750219, 0.000900653400832268, 0.000895689148548734, 
			0.000890780152808577, 0.00088592549155665, 0.000881124263189574, 0.000876375585991002, 
			0.000871678597585497, 0.000867032454410339, 0.000862436331204554, 0.000857889420514529, 
			0.000853390932215581, 0.000848940093048882, 0.000844536146173171, 0.0008401783507307, 
			0.000835865981426895, 0.000831598328123223, 0.000827374695442785, 0.00082319440238818, 
			0.000819056781971177, 0.000814961180853801, 0.000810906959000393, 0.000806893489340281, 
			0.000802920157440663, 0.000798986361189363, 0.000795091510487103, 0.000791235026948955, 
			0.000787416343614671, 0.000783634904667565, 0.000779890165161673, 0.000776181590756889, 
			0.000772508657461819, 0.000768870851384088, 0.000765267668487848, 0.000761698614358249, 
			0.000758163203972633, 0.000754660961478239, 0.00075119141997619, 0.000747754121311576, 
			0.00074434861586941, 0.000740974462376276, 0.000737631227707499, 0.000734318486699628, 
			0.000731035821968086, 0.000727782823729817, 0.000724559089630764, 0.000721364224578028, 
			0.000718197840576562, 0.000715059556570263, 0.000711948998287307, 0.000708865798089617, 
			0.00070580959482632, 0.000702780033691076, 0.000699776766083158, 0.000696799449472176, 
			0.00069384774726632, 0.000690921328684028, 0.000688019868628968, 0.000685143047568243, 
			0.000682290551413704, 0.000679462071406311, 0.000676657304003412, 0.000673875950768886, 
			0.000671117718266049, 0.000668382317953249, 0.000665669466082066, 0.000662978883598044, 
			0.000660310296043889, 0.000657663433465047, 0.000655038030317605, 0.000652433825378447, 
			0.000649850561657598, 0.000647287986312695, 0.000644745850565526, 0.00064222390962058, 
			0.000639721922585543, 0.000637239652393704, 0.000634776865728198, 0.000632333332948045, 
			0.000629908828015937, 0.000627503128427719, 0.000625116015143527, 0.000622747272520526, 
			0.000620396688247211, 0.000618064053279231, 0.000615749161776693, 0.000613451811042903, 
			0.000611171801464508, 0.000608908936453005, 0.000606663022387575, 0.000604433868559212, 
			0.000602221287116109, 0.000600025093010269, 0.000597845103945314, 0.000595681140325454, 
			0.000593533025205586, 0.000591400584242499, 0.000589283645647159, 0.000587182040138028, 
			0.000585095600895422, 0.000583024163516844, 0.000580967565973304, 0.000578925648566573, 
			0.000576898253887362, 0.000574885226774397, 0.000572886414274377, 0.000570901665602773, 
			0.000568930832105474, 0.000566973767221235, 0.000565030326444919, 0.000563100367291516, 
			0.000561183749260912, 0.000559280333803396, 0.000557389984285878, 0.000555512565958818, 
			0.00055364794592383, 0.000551795993101954, 0.000549956578202583, 0.000548129573693021, 
			0.000546314853768664, 0.000544512294323784, 0.000542721772922908, 0.00054094316877277, 
			0.00053917636269483, 0.000537421237098342, 0.000535677675953961, 0.000533945564767874, 
			0.000532224790556444, 0.000530515241821357, 0.000528816808525257, 0.000527129382067859, 
			0.000525452855262534, 0.000523787122313343, 0.000522132078792526, 0.000520487621618421, 
			0.000518853649033813, 0.000517230060584699, 0.000515616757099461, 0.000514013640668438, 
			0.000512420614623885, 0.000510837583520316, 0.000509264453115218, 0.000507701130350133, 
			0.000506147523332088, 0.000504603541315382, 0.000503069094683712, 0.000501544094932629, 
			0.00050002845465232, 0.000498522087510718, 0.000497024908236915, 0.000495536832604881, 
			0.000494057777417489, 0.000492587660490825, 0.000491126400638789, 0.000489673917657974, 
			0.000488230132312825, 0.000486794966321053, 0.000485368342339331, 0.000483950183949228, 
			0.000482540415643411, 0.000481138962812086, 0.000479745751729677, 0.000478360709541753, 
			0.000476983764252175, 0.000475614844710477, 0.000474253880599468, 0.000472900802423048, 
			0.000471555541494244, 0.000470218029923449, 0.000468888200606866, 0.000467565987215159, 
			0.000466251324182293, 0.000464944146694569, 0.000463644390679848, 0.000462351992796962, 
			0.000461066890425301, 0.000459789021654583, 0.000458518325274795, 0.000457254740766304, 
			0.000455998208290139, 0.000454748668678432, 0.000453506063425023, 0.000452270334676223, 
			0.000451041425221727, 0.000449819278485686, 0.00044860383851792, 0.00044739504998528, 
			0.000446192858163155, 0.000444997208927117, 0.000443808048744697, 0.000442625324667312, 
			0.000441448984322308, 0.000440278975905137, 0.000439115248171671, 0.000437957750430626, 
			0.000436806432536117, 0.000435661244880337, 0.000434522138386339, 0.000433389064500951, 
			0.000432261975187794, 0.000431140822920415, 0.000430025560675527, 0.000428916141926358, 
			0.000427812520636108, 0.000426714651251502, 0.000425622488696453, 0.00042453598836582, 
			0.000423455106119261, 0.00042237979827519, 0.000421310021604821, 0.000420245733326309, 
			0.000419186891098978, 0.000418133453017642, 0.000417085377607013, 0.000416042623816192, 
			0.000415005151013246, 0.000413972918979874, 0.000412945887906141, 0.000411924018385307, 
			0.000410907271408726, 0.000409895608360823, 0.000408888991014147, 0.000407887381524504, 
			0.000406890742426154, 0.00040589903662709, 0.000404912227404377, 0.00040393027839957, 
			0.000402953153614196, 0.0004019808174053, 0.000401013234481066, 0.000400050369896492, 
			0.000399092189049137, 0.000398138657674927, 0.000397189741844021, 0.000396245407956741, 
			0.000395305622739561, 0.000394370353241151, 0.000393439566828481, 0.000392513231182983, 
			0.000391591314296766, 0.000390673784468883, 0.00038976061030166, 0.00038885176069707, 
			0.000387947204853161, 0.000387046912260537, 0.000386150852698888, 0.000385258996233565, 
			0.000384371313212215, 0.000383487774261447, 0.000382608350283564, 0.000381733012453324, 
			0.000380861732214755, 0.000379994481278016, 0.0003791312316163, 0.000378271955462773, 
			0.00037741662530757, 0.00037656521389482, 0.000375717694219719, 0.000374874039525638,
			0.000374034223301281, 0.00037319821927787, 0.000372366001426375, 0.000371537543954782, 
			0.000370712821305397, 0.000369891808152188, 0.000369074479398159, 0.000368260810172767, 
			0.000367450775829367, 0.000366644351942696, 0.000365841514306388, 0.000365042238930524, 
			0.000364246502039214, 0.000363454280068215, 0.000362665549662573, 0.000361880287674303, 
			0.000361098471160101, 0.000360320077379077, 0.000359545083790532, 0.000358773468051749, 
			0.000358005208015827, 0.000357240281729535, 0.000356478667431194, 0.000355720343548594, 
			0.000354965288696929, 0.000354213481676766, 0.000353464901472038, 0.000352719527248059, 
			0.000351977338349573, 0.000351238314298823, 0.000350502434793643, 0.000349769679705578, 
			0.000349040029078029, 0.00034831346312442, 0.000347589962226384, 0.000346869506931985, 
			0.000346152077953946, 0.000345437656167911, 0.000344726222610728, 0.000344017758478748, 
			0.000343312245126151, 0.00034260966406329, 0.000341909996955058, 0.000341213225619274, 
			0.000340519332025088, 0.000339828298291411, 0.000339140106685357, 0.00033845473962071, 
			0.000337772179656412, 0.000337092409495059, 0.000336415411981429, 0.00033574117010102, 
			0.000335069666978606, 0.000334400885876816, 0.000333734810194724, 0.000333071423466462, 
			0.000332410709359846, 0.000331752651675019, 0.000331097234343113, 0.000330444441424927, 
			0.000329794257109615, 0.0003291466657134, 0.000328501651678296, 0.000327859199570846, 
			0.000327219294080879, 0.000326581920020279, 0.000325947062321767, 0.000325314706037704])


class Params: 
	'''
	Disease parameters 
	'''
	def __init__(self, unit = 26): 
		self.init_prev = 0.07
		self.pInf = 0.11
		self.pCondom = 0.44
		self.redCondom = 0.6
		durI = 1 / 2 # annual scale
		# durI = 1
		self.pRec = 1 - np.exp(- 1 / (durI * unit))
		rScr = 0.3 # annual acale
		self.pScr = 1 - np.exp(np.log(1 - rScr) / unit)
		self.pContact_PN = 0.49
		self.pContact_ept = 0.7
		self.pContact_tr = 0.7
		self.p_treat_PN = 0.71
		self.p_treat_ept = 0.79
		self.p_treat_tr = 0.79
		self.max_contact = 360 # annual scale
		self.max_contact = np.round(self.max_contact / unit).astype(int)
		self.max_ept = 6000 # annual scale
		self.max_ept = np.round(self.max_ept / unit).astype(int)
		self.alpha = 1
		self.cMedicine = np.mean([46, 39, 45, 45, 97, 86, 51, 56])
		self.cInvestigate = 120
		self.cTest = np.mean([117, 110, 70, 70, 183, 122, 70, 70])
		self.n_cluster = 5
		self.q = 0.99 # multiplier of the utility of the infected 
		self.discount_rate = 0.03 # annual scale
		self.discount_rate = self.discount_rate / unit


class SexBehavior: 
	def __init__(self, unit = 14):
		unit_vec = np.array([np.round(30 / unit), np.round(6 * 30 / unit), np.round(6 * 30 / unit), \
			np.round(12 * 30 / unit), np.round(12 * 30 / unit)]).astype(int)
		self.dur = np.arange(np.sum(unit_vec)) 
		raw_dist = np.array([0.558, 0.216, 0.073, 0.074, 0.023])
		convert_dist = np.repeat(raw_dist / unit_vec, unit_vec)
		self.dur_dist = convert_dist / np.sum(convert_dist)
