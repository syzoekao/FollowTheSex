import numpy as np
import copy
import timeit
import netSTI.net as net
import netSTI.mydata as data
import netSTI.copula as copula
import pytest

import matplotlib as mpl
from pylab import *
print(mpl.rcParams['backend'])
mpl.use('TkAgg')
import matplotlib.pyplot as plt
plt.get_backend()
import os
os.chdir("/Users/szu-yukao/Documents/Network_structure_and_STI/networkSTI")
cwd = os.getcwd()
print(cwd)


Npop = 5000
years = 20
days = 14 # 14 days; bi-weekly time step
# graph_function = net.random_graph_generator
strategy = "null" 
meanActs = 27


Ndegree = 4 * years
unit_per_year = int(365 / days)
time_horizon = unit_per_year * years
acts = meanActs / unit_per_year

init_prev, pInf, pCondom, redCondom, pRec, pScr, \
pContact_PN, pContact_ept, pContact_tr, p_treat_PN, p_treat_ept, p_treat_tr, \
max_contact, max_ept, alpha, cMedicine, cInvestigate, cTest, \
n_cluster, q, discount_rate = net.get_params(unit_per_year)


init_inf = int(Npop * init_prev)
ID = np.arange(Npop)
S = np.ones(Npop)
I = np.zeros(Npop)
T = np.zeros(Npop) # this state is only for recording time of treatment

ID_cluster = (np.floor(ID / (Npop/n_cluster)) + 1).astype(int)
init_select = np.where(ID_cluster == 1)[0]
infID = np.sort(np.random.choice(init_select, init_inf, replace = False))
I[infID] = 1
S[infID] = 0


